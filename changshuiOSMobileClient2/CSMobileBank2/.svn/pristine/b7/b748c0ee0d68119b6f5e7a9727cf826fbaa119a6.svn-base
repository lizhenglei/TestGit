<div v-view-setup="DebitCardInfoCtrl" v-init="init()">
	<div class="bg_box" v-page v-transition="native" title="账户详情">
		<div class="box_cont">
			<div class="zz_cont">
				<ul>
					<li><em>账号：</em><i>{{AcNo|encryptAcNo:1|accountNo}}</i></li>
					<li><em>别名：</em><i>{{AcAlias}}</i></li>
					<li><em>账户余额：</em><i>{{detailInfo.Balance}}元</i></li>
					<li><em>可用余额：</em><i>{{detailInfo.AvailBal}}元</i></li>
					<!-- 						<li><em>币种：</em><i>{{detailInfo.CurrencyName}}</i></li> -->
					<li><em>所属机构：</em><i>{{detailInfo.DeptName}}</i></li>
					<!-- 						<li><em>账户类型：</em><i>{{detailInfo.VouKindName}}</i></li> -->
					<li><em>账户状态：</em><i>{{cardInfo.CoreStatus|AccStateFilter}}</i></li>
					<li><em>签约方式：</em><i>{{detailInfo.UserTypeName}}</i></li>
				</ul>
			</div>
			<div class="zz_cont">
				<input type="submit" class="button_1" name="Submit" value="交易明细"
					v-click="goTransInfoQry()">
			</div>
			<div v-show="subInfoList">
				<div class="j-heightb" style="height: 20px">我的定期</div>
			</div>
			<div v-more-page="subAcc in subInfoList">
				<div class="j-heightb"></div>
				<div class="zz_cont">
					<ul>
						<li><em>账号：</em><i>{{subAcc.SubSeq}}</i></li>
						<li><em>起存日期：</em><i>{{subAcc.BeginDate}}</i></li>
						<li><em>结束日期：</em><i>{{subAcc.EndDate}}</i></li>
						<li><em>存期：</em><i>{{subAcc.Term}}</i></li>
						<li><em>利率：</em><i>{{subAcc.Rate}}%</i></li>
						<li><em>存款金额：</em><i class="red">{{subAcc.Balance|number:2}}
								元</i></li>
					</ul>
				</div>
			</div>
			<div>
				<input type="submit" id="nextButton" class="button_1" name="Submit"
					value="查看更多" v-click="PAGE.moreNextPage()">
			</div>
		</div>
	</div>

	<!-- 	    <div class="zz_cont"><img src="images/ts.png" /> -->
	<!-- 		    <font class="tishi"> -->
	<!-- 				温馨提示</br> -->
	<!-- 			</font> -->
	<!-- 				&nbsp;&nbsp;1、账户总览仅供参考，且不含*****，请以实际信息为准。</br> -->
	<!-- 				&nbsp;&nbsp;2、别名修改支持数字、英文、汉字等，长度10位。</br> -->
	<!-- 			<div style="font-size:12px; line-height:16px; color:#929292;"> </div> -->
	<!-- 	   </div> -->
	<div style="width: 100%; height: 30px"></div>

</div>
<script>
DebitCardInfoCtrl.$inject = ["$scope","$remote","$targets","$context"];
function DebitCardInfoCtrl($scope,$remote,$targets,$context){
	
	$scope.init=function(){
		$scope.accType=$context.getJson().selectedAccType;
		$scope.cardInfo=$context.getJson().selectedPayee;
		$scope.AcNo=$scope.cardInfo.AcNo;
		if($scope.cardInfo){
			//获取账号详情
			$remote.post("/pmobile/ActBalQry.do",{"AcNo":$scope.AcNo},function(data){
				$scope.detailInfo=data;
			});
			if($scope.accType=="debitCard"){
				$scope.AcAlias=$scope.cardInfo.accountAlias;
				//获取子账号列表详情
				var params={
						"AcNo":$scope.AcNo,
						"Flag":2,//标志 1:包括活期和定期；2:只有定期
						"pageSize":10,
						"currentIndex":1
				};
				$remote.post("/pmobile/SubActsQry.do",params,function(data){
					$scope.subInfoList=data.List;
					$scope.totalnumber = data.recordNumber;
				},function(data){
					return data.jsonError;
				});
				
			}else if($scope.accType=="tim"){
				$scope.AcNo=$scope.cardInfo.contractNo;
				$scope.AcAlias=$scope.cardInfo.accountAlias;
			}
		}
	}
	$scope.morepage = function(qishi,zhongzhi,zengliang,list){
		$scope.start=1;//不是第一次进入
		var params = {
				"AcNo":$scope.AcNo,
				"Flag":2,//1---活期   2---无活期
				"pageSize":10,
				"currentIndex":qishi/10+1
		};
		$remote.post("/pmobile/SubActsQry.do", params, function(data) {
			$scope.subInfoList=data.List;
		});
	};
	//跳转到交易明细
	$scope.goTransInfoQry=function(){
		if($scope.accType=="debitCard"){
			$scope.selectedAcNo=$scope.AcNo;
		}
		$context.setJson({"selectedAc":$scope.selectedAcNo});
		$scope.goto("DebitCardInfo","PTransInfoQry");
	}
	
}
</script>