//
//  CSIIFinancingProductViewController.m
//  MobileClient
//
//  Created by 张海亮 on 13-8-19.
//  Copyright (c) 2013年 pro. All rights reserved.
//

#import "CSIIFinancingProductViewController.h"
#import "CSIIUIToolbar.h"

#define FONT cell.textLabel.font = [UIFont fontWithName:@"Helvetica" size:15];
#define TEXTFIELD_FRAME CGRectMake(115,10,131, 23)
#define UNITTEXTFIELD_FRAME CGRectMake(285, 10, 20, 35)
#define MONTHLABLE_FRAME CGRectMake(225, 5, 140, 35)
#define CALCULATORTEXTFIELD_FRAME CGRectMake(115,10,150, 23)
#define CALCULATORMONTHTEXTFIELD_FRAME CGRectMake(115, 10, 90, 23)

@interface CSIIFinancingProductViewController ()
{
    UIImageView *yuanJiaoImageUp;
    UIImageView *yuanJiaoImageDown;
}
@end

@implementation CSIIFinancingProductViewController

-(void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:YES];
    ((UILabel*)[self.navigationController.navigationBar viewWithTag:99]).text = @"理财产品计算器";
}

- (id)init
{
    
    if (self = [super init]) {
        financeTable = [[UITableView alloc] initWithFrame:self.view.bounds style:UITableViewStyleGrouped];
        financeTable.backgroundView = nil;
        financeTable.backgroundColor = [UIColor clearColor];
        financeTable.delegate = self;
        financeTable.dataSource = self;
        [self.view addSubview:financeTable];
    }
    return self;
}

-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 2;
}

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    if (section == 0)
    {
        return 5;
    }
    
    return 1;
}

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section;
{
    if (section==0) {
        return 40;
    }
    return 0;
}
-(UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    if (section==0) {
        UIView *coverview0=[[UIView alloc]initWithFrame:CGRectMake(0, 0, 320, 40)];
        UIImage*image=[UIImage imageNamed:@"lineTitle.png"];
        UIImageView*imageview = [[UIImageView alloc]initWithImage:image];
        imageview.frame = CGRectMake(0, 36, 320, 4);
        UILabel*labeltitle= [[UILabel alloc]initWithFrame:CGRectMake(20, 2, 300, 30)];
        labeltitle.backgroundColor = [UIColor clearColor];
        labeltitle.font=[UIFont boldSystemFontOfSize:20];
        labeltitle.text = @"理财产品计算";
        [coverview0 addSubview:imageview];
        [coverview0 addSubview:labeltitle];
        
        return coverview0;
    }
    
    return nil;
}



- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    tableView.separatorStyle = UITableViewCellSeparatorStyleSingleLine;
    NSString *CellIdentifier = [NSString stringWithFormat:@"1%d row%d",indexPath.section,indexPath.row];
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell==nil) {
        cell=[[UITableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
        cell.backgroundColor = [UIColor clearColor];
        cell.selectionStyle = UITableViewCellSelectionStyleNone;
    }
        if(indexPath.section == 0){

            switch (indexPath.row) {
                case 0:{
                    cell.selectionStyle =UITableViewCellSelectionStyleNone;
                    cell.textLabel.text=@"产品期限：";
                    cell.backgroundView = yuanJiaoImageUp;
                    saveTime=[[CSIITextField alloc] initWithFrame:TEXTFIELD_FRAME];
                    saveTime.placeholder = @"月";
                    saveTime.textAlignment = NSTextAlignmentLeft;
                    saveTime.clearButtonMode = UITextFieldViewModeWhileEditing;
                    saveTime.BorderStyle=UITextBorderStyleNone;
                    [self.inputControls addObject:saveTime];

                    saveTime.keyboardType=UIKeyboardTypeDecimalPad;
                    saveTime.delegate=self;
                    [cell.contentView addSubview:saveTime];
                    
                    UIImageView *xiala = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"下拉.png"]];
                    xiala.frame = CGRectMake(256, cell.frame.origin.y, 44, 44);
                    
                    [cell.contentView addSubview:xiala];
                    break;
                }
                case 1:{
                    cell.selectionStyle =UITableViewCellSelectionStyleNone;
                    cell.textLabel.text=@"产品金额：";
                    UIImageView* rectangleImage1 = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"安全中心_r2_c1.png"]];
                    cell.backgroundView = rectangleImage1;                    moneyNum=[[CSIITextField alloc] initWithFrame:TEXTFIELD_FRAME];
                    moneyNum.placeholder = @"元";
                    moneyNum.textAlignment = NSTextAlignmentLeft;
                    moneyNum.clearButtonMode = UITextFieldViewModeWhileEditing;
                    moneyNum.BorderStyle=UITextBorderStyleNone;
                    [self.inputControls addObject:moneyNum];
                    moneyNum.keyboardType=UIKeyboardTypeDecimalPad;
                    moneyNum.delegate=self;
                    [cell.contentView addSubview:moneyNum];
                    
                    UIImageView *xiala = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"下拉.png"]];
                    xiala.frame = CGRectMake(256, cell.frame.origin.y, 44, 44);
                    
                    [cell.contentView addSubview:xiala];                    break;
                }
                case 2:{
                    cell.selectionStyle =UITableViewCellSelectionStyleNone;
                    cell.textLabel.text=@"产品受益率：";
                    UIImageView* rectangleImage1 = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"安全中心_r2_c1.png"]];
                    cell.backgroundView = rectangleImage1;                    moneyRate=[[CSIITextField alloc] initWithFrame:TEXTFIELD_FRAME];
                    moneyRate.textAlignment = NSTextAlignmentLeft;
                    moneyRate.placeholder = @"月利率";
                    moneyRate.clearButtonMode = UITextFieldViewModeWhileEditing;
                    moneyRate.BorderStyle=UITextBorderStyleNone;
                    [self.inputControls addObject:moneyRate];
                    moneyRate.keyboardType=UIKeyboardTypeDecimalPad;
                    moneyRate.delegate=self;
                    [cell.contentView addSubview:moneyRate];
                    
                    UIImageView *xiala = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"下拉.png"]];
                    xiala.frame = CGRectMake(256, cell.frame.origin.y, 44, 44);
                    
                    [cell.contentView addSubview:xiala];                    break;
                }
                case 3:{
                    cell.selectionStyle =UITableViewCellSelectionStyleNone;
                    cell.textLabel.text=@"利息收入：";
                    UIImageView* rectangleImage1 = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"安全中心_r2_c1.png"]];
                    cell.backgroundView = rectangleImage1;                    resultlable=[[UILabel alloc] initWithFrame:TEXTFIELD_FRAME];
                    resultlable.textAlignment = NSTextAlignmentRight;
                    resultlable.backgroundColor = [UIColor clearColor];
                    [cell.contentView addSubview:resultlable];
                   break;
                }
                case 4:
                {
                    cell.selectionStyle =UITableViewCellSelectionStyleNone;
                    cell.backgroundView = yuanJiaoImageDown;
                    cell.textLabel.text=@"本息总计：";
                    
                    resultlableAmount=[[UILabel alloc] initWithFrame:TEXTFIELD_FRAME];
                    resultlableAmount.textAlignment = NSTextAlignmentRight;
                    resultlableAmount.backgroundColor = [UIColor clearColor];
                    
                    [cell.contentView addSubview:
                     resultlableAmount];
                }

            }
        }else if(indexPath.section == 1){
            cell.selectionStyle = UITableViewCellSelectionStyleNone;
            UIView *tempView=[[UIView alloc]init];
            tempView.backgroundColor=[UIColor clearColor];
            cell.backgroundView=tempView;
            UILabel* label = [[UILabel alloc]initWithFrame:CGRectMake(0, 0, 260, 40)];
            label.font = [UIFont systemFontOfSize:22];
            label.text = @"测算";
            label.textColor = [UIColor whiteColor];
            label.textAlignment=NSTextAlignmentCenter;
            label.backgroundColor = [UIColor clearColor];
            
            UIButton* calculatebtn = [UIButton buttonWithType:UIButtonTypeCustom];
            calculatebtn.frame = CGRectMake(20, 0, 260, 40);
            [calculatebtn setBackgroundImage:[UIImage imageNamed:@"按钮_r1_c1.png"] forState:UIControlStateNormal];
            [calculatebtn setBackgroundImage:[UIImage imageNamed:@"按钮_r3_c2.png"] forState:UIControlStateHighlighted];            [calculatebtn addSubview:label];
            calculatebtn.layer.masksToBounds= YES;
            calculatebtn.layer.cornerRadius = 10.f;
            //[calculatebtn setTitle:@"测算" forState:UIControlStateNormal];
            [calculatebtn addTarget:self action:@selector(btndown) forControlEvents:UIControlEventTouchUpInside];
            [cell.contentView addSubview:calculatebtn];
            
        }
    
    
    // Configure the cell...
    
    return cell;
}

-(void)btndown
{
    double moneyMore = [moneyNum.text doubleValue]*[saveTime.text doubleValue]*([moneyRate.text doubleValue]/100);
    resultlable.text = [NSString stringWithFormat:@"%0.2lf元",moneyMore];
    resultlableAmount.text = [NSString stringWithFormat:@"%0.2lf元",[moneyNum.text doubleValue]+moneyMore];
    
}
- (void)viewDidLoad
{
    [super viewDidLoad];
	// Do any additional setup after loading the view.
    yuanJiaoImageUp = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"安全中心_r1_c1.png"]];
    
    yuanJiaoImageDown = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"安全中心_r4_c1.png"]];
}

//收键盘回调
-(BOOL)textFieldShouldReturn:(UITextField *)textField{
    [textField resignFirstResponder];
    return YES;
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end
